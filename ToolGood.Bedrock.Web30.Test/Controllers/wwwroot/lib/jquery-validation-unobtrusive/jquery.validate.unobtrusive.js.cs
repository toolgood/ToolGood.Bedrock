using Microsoft.AspNetCore.Mvc;
using System;
namespace ToolGood.WwwRoot.Test
{
    public partial class WwwRootController : Controller
    {
        [HttpGet("lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js")]
        public IActionResult lib_jquery_validation_unobtrusive_jquery_validate_unobtrusive_js()
        {
            if (Request.Headers["If-None-Match"]  == "D8FB3A963112BE9510687BA1BDC724B2") {
                Response.Headers["Expires"] = DateTime.Now.AddYears(100).ToString("r");
                return StatusCode(304);
            }
            Response.Headers["Cache-Control"] = "max-age=315360000";
            Response.Headers["Etag"] = "D8FB3A963112BE9510687BA1BDC724B2";
            Response.Headers["Date"] = DateTime.Now.ToString("r");
            Response.Headers["Expires"] = DateTime.Now.AddYears(100).ToString("r");
            const string s = "Ly8gVW5vYnRydXNpdmUgdmFsaWRhdGlvbiBzdXBwb3J0IGxpYnJhcnkgZm9yIGpRdWVyeSBhbmQgalF1ZXJ5IFZhbGlkYXRlDQovLyBDb3B5cmlnaHQgKGMpIC5ORVQgRm91bmRhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLg0KLy8gQHZlcnNpb24gdjMuMi4xMQ0KDQovKmpzbGludCB3aGl0ZTogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgb25ldmFyOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbm9tZW46IHRydWUsIGVxZXFlcTogdHJ1ZSwgcGx1c3BsdXM6IHRydWUsIGJpdHdpc2U6IHRydWUsIHJlZ2V4cDogdHJ1ZSwgbmV3Y2FwOiB0cnVlLCBpbW1lZDogdHJ1ZSwgc3RyaWN0OiBmYWxzZSAqLw0KLypnbG9iYWwgZG9jdW1lbnQ6IGZhbHNlLCBqUXVlcnk6IGZhbHNlICovDQoNCihmdW5jdGlvbiAoZmFjdG9yeSkgew0KICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsNCiAgICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLg0KICAgICAgICBkZWZpbmUoImpxdWVyeS52YWxpZGF0ZS51bm9idHJ1c2l2ZSIsIFsnanF1ZXJ5LXZhbGlkYXRpb24nXSwgZmFjdG9yeSk7DQogICAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykgew0KICAgICAgICAvLyBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB0aGF0IHN1cHBvcnQgbW9kdWxlLmV4cG9ydHMgICAgIA0KICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnanF1ZXJ5LXZhbGlkYXRpb24nKSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gQnJvd3NlciBnbG9iYWwNCiAgICAgICAgalF1ZXJ5LnZhbGlkYXRvci51bm9idHJ1c2l2ZSA9IGZhY3RvcnkoalF1ZXJ5KTsNCiAgICB9DQp9KGZ1bmN0aW9uICgkKSB7DQogICAgdmFyICRqUXZhbCA9ICQudmFsaWRhdG9yLA0KICAgICAgICBhZGFwdGVycywNCiAgICAgICAgZGF0YV92YWxpZGF0aW9uID0gInVub2J0cnVzaXZlVmFsaWRhdGlvbiI7DQoNCiAgICBmdW5jdGlvbiBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsIHJ1bGVOYW1lLCB2YWx1ZSkgew0KICAgICAgICBvcHRpb25zLnJ1bGVzW3J1bGVOYW1lXSA9IHZhbHVlOw0KICAgICAgICBpZiAob3B0aW9ucy5tZXNzYWdlKSB7DQogICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2VzW3J1bGVOYW1lXSA9IG9wdGlvbnMubWVzc2FnZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHNwbGl0QW5kVHJpbSh2YWx1ZSkgew0KICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXlxzK3xccyskL2csICIiKS5zcGxpdCgvXHMqLFxzKi9nKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBlc2NhcGVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSkgew0KICAgICAgICAvLyBBcyBtZW50aW9uZWQgb24gaHR0cDovL2FwaS5qcXVlcnkuY29tL2NhdGVnb3J5L3NlbGVjdG9ycy8NCiAgICAgICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoLyhbISIjJCUmJygpKissLi86Ozw9Pj9AXFtcXFxdXmB7fH1+XSkvZywgIlxcJDEiKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRNb2RlbFByZWZpeChmaWVsZE5hbWUpIHsNCiAgICAgICAgcmV0dXJuIGZpZWxkTmFtZS5zdWJzdHIoMCwgZmllbGROYW1lLmxhc3RJbmRleE9mKCIuIikgKyAxKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhcHBlbmRNb2RlbFByZWZpeCh2YWx1ZSwgcHJlZml4KSB7DQogICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCIqLiIpID09PSAwKSB7DQogICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoIiouIiwgcHJlZml4KTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdmFsdWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gb25FcnJvcihlcnJvciwgaW5wdXRFbGVtZW50KSB7ICAvLyAndGhpcycgaXMgdGhlIGZvcm0gZWxlbWVudA0KICAgICAgICB2YXIgY29udGFpbmVyID0gJCh0aGlzKS5maW5kKCJbZGF0YS12YWxtc2ctZm9yPSciICsgZXNjYXBlQXR0cmlidXRlVmFsdWUoaW5wdXRFbGVtZW50WzBdLm5hbWUpICsgIiddIiksDQogICAgICAgICAgICByZXBsYWNlQXR0clZhbHVlID0gY29udGFpbmVyLmF0dHIoImRhdGEtdmFsbXNnLXJlcGxhY2UiKSwNCiAgICAgICAgICAgIHJlcGxhY2UgPSByZXBsYWNlQXR0clZhbHVlID8gJC5wYXJzZUpTT04ocmVwbGFjZUF0dHJWYWx1ZSkgIT09IGZhbHNlIDogbnVsbDsNCg0KICAgICAgICBjb250YWluZXIucmVtb3ZlQ2xhc3MoImZpZWxkLXZhbGlkYXRpb24tdmFsaWQiKS5hZGRDbGFzcygiZmllbGQtdmFsaWRhdGlvbi1lcnJvciIpOw0KICAgICAgICBlcnJvci5kYXRhKCJ1bm9idHJ1c2l2ZUNvbnRhaW5lciIsIGNvbnRhaW5lcik7DQoNCiAgICAgICAgaWYgKHJlcGxhY2UpIHsNCiAgICAgICAgICAgIGNvbnRhaW5lci5lbXB0eSgpOw0KICAgICAgICAgICAgZXJyb3IucmVtb3ZlQ2xhc3MoImlucHV0LXZhbGlkYXRpb24tZXJyb3IiKS5hcHBlbmRUbyhjb250YWluZXIpOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZXJyb3IuaGlkZSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gb25FcnJvcnMoZXZlbnQsIHZhbGlkYXRvcikgeyAgLy8gJ3RoaXMnIGlzIHRoZSBmb3JtIGVsZW1lbnQNCiAgICAgICAgdmFyIGNvbnRhaW5lciA9ICQodGhpcykuZmluZCgiW2RhdGEtdmFsbXNnLXN1bW1hcnk9dHJ1ZV0iKSwNCiAgICAgICAgICAgIGxpc3QgPSBjb250YWluZXIuZmluZCgidWwiKTsNCg0KICAgICAgICBpZiAobGlzdCAmJiBsaXN0Lmxlbmd0aCAmJiB2YWxpZGF0b3IuZXJyb3JMaXN0Lmxlbmd0aCkgew0KICAgICAgICAgICAgbGlzdC5lbXB0eSgpOw0KICAgICAgICAgICAgY29udGFpbmVyLmFkZENsYXNzKCJ2YWxpZGF0aW9uLXN1bW1hcnktZXJyb3JzIikucmVtb3ZlQ2xhc3MoInZhbGlkYXRpb24tc3VtbWFyeS12YWxpZCIpOw0KDQogICAgICAgICAgICAkLmVhY2godmFsaWRhdG9yLmVycm9yTGlzdCwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICQoIjxsaSAvPiIpLmh0bWwodGhpcy5tZXNzYWdlKS5hcHBlbmRUbyhsaXN0KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gb25TdWNjZXNzKGVycm9yKSB7ICAvLyAndGhpcycgaXMgdGhlIGZvcm0gZWxlbWVudA0KICAgICAgICB2YXIgY29udGFpbmVyID0gZXJyb3IuZGF0YSgidW5vYnRydXNpdmVDb250YWluZXIiKTsNCg0KICAgICAgICBpZiAoY29udGFpbmVyKSB7DQogICAgICAgICAgICB2YXIgcmVwbGFjZUF0dHJWYWx1ZSA9IGNvbnRhaW5lci5hdHRyKCJkYXRhLXZhbG1zZy1yZXBsYWNlIiksDQogICAgICAgICAgICAgICAgcmVwbGFjZSA9IHJlcGxhY2VBdHRyVmFsdWUgPyAkLnBhcnNlSlNPTihyZXBsYWNlQXR0clZhbHVlKSA6IG51bGw7DQoNCiAgICAgICAgICAgIGNvbnRhaW5lci5hZGRDbGFzcygiZmllbGQtdmFsaWRhdGlvbi12YWxpZCIpLnJlbW92ZUNsYXNzKCJmaWVsZC12YWxpZGF0aW9uLWVycm9yIik7DQogICAgICAgICAgICBlcnJvci5yZW1vdmVEYXRhKCJ1bm9idHJ1c2l2ZUNvbnRhaW5lciIpOw0KDQogICAgICAgICAgICBpZiAocmVwbGFjZSkgew0KICAgICAgICAgICAgICAgIGNvbnRhaW5lci5lbXB0eSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gb25SZXNldChldmVudCkgeyAgLy8gJ3RoaXMnIGlzIHRoZSBmb3JtIGVsZW1lbnQNCiAgICAgICAgdmFyICRmb3JtID0gJCh0aGlzKSwNCiAgICAgICAgICAgIGtleSA9ICdfX2pxdWVyeV91bm9idHJ1c2l2ZV92YWxpZGF0aW9uX2Zvcm1fcmVzZXQnOw0KICAgICAgICBpZiAoJGZvcm0uZGF0YShrZXkpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgLy8gU2V0IGEgZmxhZyB0aGF0IGluZGljYXRlcyB3ZSdyZSBjdXJyZW50bHkgcmVzZXR0aW5nIHRoZSBmb3JtLg0KICAgICAgICAkZm9ybS5kYXRhKGtleSwgdHJ1ZSk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICAkZm9ybS5kYXRhKCJ2YWxpZGF0b3IiKS5yZXNldEZvcm0oKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICRmb3JtLnJlbW92ZURhdGEoa2V5KTsNCiAgICAgICAgfQ0KDQogICAgICAgICRmb3JtLmZpbmQoIi52YWxpZGF0aW9uLXN1bW1hcnktZXJyb3JzIikNCiAgICAgICAgICAgIC5hZGRDbGFzcygidmFsaWRhdGlvbi1zdW1tYXJ5LXZhbGlkIikNCiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygidmFsaWRhdGlvbi1zdW1tYXJ5LWVycm9ycyIpOw0KICAgICAgICAkZm9ybS5maW5kKCIuZmllbGQtdmFsaWRhdGlvbi1lcnJvciIpDQogICAgICAgICAgICAuYWRkQ2xhc3MoImZpZWxkLXZhbGlkYXRpb24tdmFsaWQiKQ0KICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCJmaWVsZC12YWxpZGF0aW9uLWVycm9yIikNCiAgICAgICAgICAgIC5yZW1vdmVEYXRhKCJ1bm9idHJ1c2l2ZUNvbnRhaW5lciIpDQogICAgICAgICAgICAuZmluZCgiPioiKSAgLy8gSWYgd2Ugd2VyZSB1c2luZyB2YWxtc2ctcmVwbGFjZSwgZ2V0IHRoZSB1bmRlcmx5aW5nIGVycm9yDQogICAgICAgICAgICAucmVtb3ZlRGF0YSgidW5vYnRydXNpdmVDb250YWluZXIiKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiB2YWxpZGF0aW9uSW5mbyhmb3JtKSB7DQogICAgICAgIHZhciAkZm9ybSA9ICQoZm9ybSksDQogICAgICAgICAgICByZXN1bHQgPSAkZm9ybS5kYXRhKGRhdGFfdmFsaWRhdGlvbiksDQogICAgICAgICAgICBvblJlc2V0UHJveHkgPSAkLnByb3h5KG9uUmVzZXQsIGZvcm0pLA0KICAgICAgICAgICAgZGVmYXVsdE9wdGlvbnMgPSAkalF2YWwudW5vYnRydXNpdmUub3B0aW9ucyB8fCB7fSwNCiAgICAgICAgICAgIGV4ZWNJbkNvbnRleHQgPSBmdW5jdGlvbiAobmFtZSwgYXJncykgew0KICAgICAgICAgICAgICAgIHZhciBmdW5jID0gZGVmYXVsdE9wdGlvbnNbbmFtZV07DQogICAgICAgICAgICAgICAgZnVuYyAmJiAkLmlzRnVuY3Rpb24oZnVuYykgJiYgZnVuYy5hcHBseShmb3JtLCBhcmdzKTsNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgaWYgKCFyZXN1bHQpIHsNCiAgICAgICAgICAgIHJlc3VsdCA9IHsNCiAgICAgICAgICAgICAgICBvcHRpb25zOiB7ICAvLyBvcHRpb25zIHN0cnVjdHVyZSBwYXNzZWQgdG8galF1ZXJ5IFZhbGlkYXRlJ3MgdmFsaWRhdGUoKSBtZXRob2QNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDbGFzczogZGVmYXVsdE9wdGlvbnMuZXJyb3JDbGFzcyB8fCAiaW5wdXQtdmFsaWRhdGlvbi1lcnJvciIsDQogICAgICAgICAgICAgICAgICAgIGVycm9yRWxlbWVudDogZGVmYXVsdE9wdGlvbnMuZXJyb3JFbGVtZW50IHx8ICJzcGFuIiwNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JQbGFjZW1lbnQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3IuYXBwbHkoZm9ybSwgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWNJbkNvbnRleHQoImVycm9yUGxhY2VtZW50IiwgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgaW52YWxpZEhhbmRsZXI6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3JzLmFwcGx5KGZvcm0sIGFyZ3VtZW50cyk7DQogICAgICAgICAgICAgICAgICAgICAgICBleGVjSW5Db250ZXh0KCJpbnZhbGlkSGFuZGxlciIsIGFyZ3VtZW50cyk7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiB7fSwNCiAgICAgICAgICAgICAgICAgICAgcnVsZXM6IHt9LA0KICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvblN1Y2Nlc3MuYXBwbHkoZm9ybSwgYXJndW1lbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWNJbkNvbnRleHQoInN1Y2Nlc3MiLCBhcmd1bWVudHMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBhdHRhY2hWYWxpZGF0aW9uOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICRmb3JtDQogICAgICAgICAgICAgICAgICAgICAgICAub2ZmKCJyZXNldC4iICsgZGF0YV92YWxpZGF0aW9uLCBvblJlc2V0UHJveHkpDQogICAgICAgICAgICAgICAgICAgICAgICAub24oInJlc2V0LiIgKyBkYXRhX3ZhbGlkYXRpb24sIG9uUmVzZXRQcm94eSkNCiAgICAgICAgICAgICAgICAgICAgICAgIC52YWxpZGF0ZSh0aGlzLm9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgdmFsaWRhdGU6IGZ1bmN0aW9uICgpIHsgIC8vIGEgdmFsaWRhdGlvbiBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBieSB1bm9idHJ1c2l2ZSBBamF4DQogICAgICAgICAgICAgICAgICAgICRmb3JtLnZhbGlkYXRlKCk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkZm9ybS52YWxpZCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQogICAgICAgICAgICAkZm9ybS5kYXRhKGRhdGFfdmFsaWRhdGlvbiwgcmVzdWx0KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfQ0KDQogICAgJGpRdmFsLnVub2J0cnVzaXZlID0gew0KICAgICAgICBhZGFwdGVyczogW10sDQoNCiAgICAgICAgcGFyc2VFbGVtZW50OiBmdW5jdGlvbiAoZWxlbWVudCwgc2tpcEF0dGFjaCkgew0KICAgICAgICAgICAgLy8vIDxzdW1tYXJ5Pg0KICAgICAgICAgICAgLy8vIFBhcnNlcyBhIHNpbmdsZSBIVE1MIGVsZW1lbnQgZm9yIHVub2J0cnVzaXZlIHZhbGlkYXRpb24gYXR0cmlidXRlcy4NCiAgICAgICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9ImVsZW1lbnQiIGRvbUVsZW1lbnQ9InRydWUiPlRoZSBIVE1MIGVsZW1lbnQgdG8gYmUgcGFyc2VkLjwvcGFyYW0+DQogICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9InNraXBBdHRhY2giIHR5cGU9IkJvb2xlYW4iPltPcHRpb25hbF0gdHJ1ZSB0byBza2lwIGF0dGFjaGluZyB0aGUNCiAgICAgICAgICAgIC8vLyB2YWxpZGF0aW9uIHRvIHRoZSBmb3JtLiBJZiBwYXJzaW5nIGp1c3QgdGhpcyBzaW5nbGUgZWxlbWVudCwgeW91IHNob3VsZCBzcGVjaWZ5IHRydWUuDQogICAgICAgICAgICAvLy8gSWYgcGFyc2luZyBzZXZlcmFsIGVsZW1lbnRzLCB5b3Ugc2hvdWxkIHNwZWNpZnkgZmFsc2UsIGFuZCBtYW51YWxseSBhdHRhY2ggdGhlIHZhbGlkYXRpb24NCiAgICAgICAgICAgIC8vLyB0byB0aGUgZm9ybSB3aGVuIHlvdSBhcmUgZmluaXNoZWQuIFRoZSBkZWZhdWx0IGlzIGZhbHNlLjwvcGFyYW0+DQogICAgICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpLA0KICAgICAgICAgICAgICAgIGZvcm0gPSAkZWxlbWVudC5wYXJlbnRzKCJmb3JtIilbMF0sDQogICAgICAgICAgICAgICAgdmFsSW5mbywgcnVsZXMsIG1lc3NhZ2VzOw0KDQogICAgICAgICAgICBpZiAoIWZvcm0pIHsgIC8vIENhbm5vdCBkbyBjbGllbnQtc2lkZSB2YWxpZGF0aW9uIHdpdGhvdXQgYSBmb3JtDQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YWxJbmZvID0gdmFsaWRhdGlvbkluZm8oZm9ybSk7DQogICAgICAgICAgICB2YWxJbmZvLm9wdGlvbnMucnVsZXNbZWxlbWVudC5uYW1lXSA9IHJ1bGVzID0ge307DQogICAgICAgICAgICB2YWxJbmZvLm9wdGlvbnMubWVzc2FnZXNbZWxlbWVudC5uYW1lXSA9IG1lc3NhZ2VzID0ge307DQoNCiAgICAgICAgICAgICQuZWFjaCh0aGlzLmFkYXB0ZXJzLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIHByZWZpeCA9ICJkYXRhLXZhbC0iICsgdGhpcy5uYW1lLA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJGVsZW1lbnQuYXR0cihwcmVmaXgpLA0KICAgICAgICAgICAgICAgICAgICBwYXJhbVZhbHVlcyA9IHt9Ow0KDQogICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkgeyAgLy8gQ29tcGFyZSBhZ2FpbnN0IHVuZGVmaW5lZCwgYmVjYXVzZSBhbiBlbXB0eSBtZXNzYWdlIGlzIGxlZ2FsIChhbmQgZmFsc3kpDQogICAgICAgICAgICAgICAgICAgIHByZWZpeCArPSAiLSI7DQoNCiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHRoaXMucGFyYW1zLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbVZhbHVlc1t0aGlzXSA9ICRlbGVtZW50LmF0dHIocHJlZml4ICsgdGhpcyk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgIHRoaXMuYWRhcHQoew0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm06IGZvcm0sDQogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbVZhbHVlcywNCiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzOiBydWxlcywNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgJC5leHRlbmQocnVsZXMsIHsgIl9fZHVtbXlfXyI6IHRydWUgfSk7DQoNCiAgICAgICAgICAgIGlmICghc2tpcEF0dGFjaCkgew0KICAgICAgICAgICAgICAgIHZhbEluZm8uYXR0YWNoVmFsaWRhdGlvbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHBhcnNlOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsNCiAgICAgICAgICAgIC8vLyA8c3VtbWFyeT4NCiAgICAgICAgICAgIC8vLyBQYXJzZXMgYWxsIHRoZSBIVE1MIGVsZW1lbnRzIGluIHRoZSBzcGVjaWZpZWQgc2VsZWN0b3IuIEl0IGxvb2tzIGZvciBpbnB1dCBlbGVtZW50cyBkZWNvcmF0ZWQNCiAgICAgICAgICAgIC8vLyB3aXRoIHRoZSBbZGF0YS12YWw9dHJ1ZV0gYXR0cmlidXRlIHZhbHVlIGFuZCBlbmFibGVzIHZhbGlkYXRpb24gYWNjb3JkaW5nIHRvIHRoZSBkYXRhLXZhbC0qDQogICAgICAgICAgICAvLy8gYXR0cmlidXRlIHZhbHVlcy4NCiAgICAgICAgICAgIC8vLyA8L3N1bW1hcnk+DQogICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9InNlbGVjdG9yIiB0eXBlPSJTdHJpbmciPkFueSB2YWxpZCBqUXVlcnkgc2VsZWN0b3IuPC9wYXJhbT4NCg0KICAgICAgICAgICAgLy8gJGZvcm1zIGluY2x1ZGVzIGFsbCBmb3JtcyBpbiBzZWxlY3RvcidzIERPTSBoaWVyYXJjaHkgKHBhcmVudCwgY2hpbGRyZW4gYW5kIHNlbGYpIHRoYXQgaGF2ZSBhdCBsZWFzdCBvbmUNCiAgICAgICAgICAgIC8vIGVsZW1lbnQgd2l0aCBkYXRhLXZhbD10cnVlDQogICAgICAgICAgICB2YXIgJHNlbGVjdG9yID0gJChzZWxlY3RvciksDQogICAgICAgICAgICAgICAgJGZvcm1zID0gJHNlbGVjdG9yLnBhcmVudHMoKQ0KICAgICAgICAgICAgICAgICAgICAuYWRkQmFjaygpDQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoImZvcm0iKQ0KICAgICAgICAgICAgICAgICAgICAuYWRkKCRzZWxlY3Rvci5maW5kKCJmb3JtIikpDQogICAgICAgICAgICAgICAgICAgIC5oYXMoIltkYXRhLXZhbD10cnVlXSIpOw0KDQogICAgICAgICAgICAkc2VsZWN0b3IuZmluZCgiW2RhdGEtdmFsPXRydWVdIikuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgJGpRdmFsLnVub2J0cnVzaXZlLnBhcnNlRWxlbWVudCh0aGlzLCB0cnVlKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAkZm9ybXMuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZm8gPSB2YWxpZGF0aW9uSW5mbyh0aGlzKTsNCiAgICAgICAgICAgICAgICBpZiAoaW5mbykgew0KICAgICAgICAgICAgICAgICAgICBpbmZvLmF0dGFjaFZhbGlkYXRpb24oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBhZGFwdGVycyA9ICRqUXZhbC51bm9idHJ1c2l2ZS5hZGFwdGVyczsNCg0KICAgIGFkYXB0ZXJzLmFkZCA9IGZ1bmN0aW9uIChhZGFwdGVyTmFtZSwgcGFyYW1zLCBmbikgew0KICAgICAgICAvLy8gPHN1bW1hcnk+QWRkcyBhIG5ldyBhZGFwdGVyIHRvIGNvbnZlcnQgdW5vYnRydXNpdmUgSFRNTCBpbnRvIGEgalF1ZXJ5IFZhbGlkYXRlIHZhbGlkYXRpb24uPC9zdW1tYXJ5Pg0KICAgICAgICAvLy8gPHBhcmFtIG5hbWU9ImFkYXB0ZXJOYW1lIiB0eXBlPSJTdHJpbmciPlRoZSBuYW1lIG9mIHRoZSBhZGFwdGVyIHRvIGJlIGFkZGVkLiBUaGlzIG1hdGNoZXMgdGhlIG5hbWUgdXNlZA0KICAgICAgICAvLy8gaW4gdGhlIGRhdGEtdmFsLW5ubm4gSFRNTCBhdHRyaWJ1dGUgKHdoZXJlIG5ubm4gaXMgdGhlIGFkYXB0ZXIgbmFtZSkuPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJwYXJhbXMiIHR5cGU9IkFycmF5IiBvcHRpb25hbD0idHJ1ZSI+W09wdGlvbmFsXSBBbiBhcnJheSBvZiBwYXJhbWV0ZXIgbmFtZXMgKHN0cmluZ3MpIHRoYXQgd2lsbA0KICAgICAgICAvLy8gYmUgZXh0cmFjdGVkIGZyb20gdGhlIGRhdGEtdmFsLW5ubm4tbW1tbSBIVE1MIGF0dHJpYnV0ZXMgKHdoZXJlIG5ubm4gaXMgdGhlIGFkYXB0ZXIgbmFtZSwgYW5kDQogICAgICAgIC8vLyBtbW1tIGlzIHRoZSBwYXJhbWV0ZXIgbmFtZSkuPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJmbiIgdHlwZT0iRnVuY3Rpb24iPlRoZSBmdW5jdGlvbiB0byBjYWxsLCB3aGljaCBhZGFwdHMgdGhlIHZhbHVlcyBmcm9tIHRoZSBIVE1MDQogICAgICAgIC8vLyBhdHRyaWJ1dGVzIGludG8galF1ZXJ5IFZhbGlkYXRlIHJ1bGVzIGFuZC9vciBtZXNzYWdlcy48L3BhcmFtPg0KICAgICAgICAvLy8gPHJldHVybnMgdHlwZT0ialF1ZXJ5LnZhbGlkYXRvci51bm9idHJ1c2l2ZS5hZGFwdGVycyIgLz4NCiAgICAgICAgaWYgKCFmbikgeyAgLy8gQ2FsbGVkIHdpdGggbm8gcGFyYW1zLCBqdXN0IGEgZnVuY3Rpb24NCiAgICAgICAgICAgIGZuID0gcGFyYW1zOw0KICAgICAgICAgICAgcGFyYW1zID0gW107DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5wdXNoKHsgbmFtZTogYWRhcHRlck5hbWUsIHBhcmFtczogcGFyYW1zLCBhZGFwdDogZm4gfSk7DQogICAgICAgIHJldHVybiB0aGlzOw0KICAgIH07DQoNCiAgICBhZGFwdGVycy5hZGRCb29sID0gZnVuY3Rpb24gKGFkYXB0ZXJOYW1lLCBydWxlTmFtZSkgew0KICAgICAgICAvLy8gPHN1bW1hcnk+QWRkcyBhIG5ldyBhZGFwdGVyIHRvIGNvbnZlcnQgdW5vYnRydXNpdmUgSFRNTCBpbnRvIGEgalF1ZXJ5IFZhbGlkYXRlIHZhbGlkYXRpb24sIHdoZXJlDQogICAgICAgIC8vLyB0aGUgalF1ZXJ5IFZhbGlkYXRlIHZhbGlkYXRpb24gcnVsZSBoYXMgbm8gcGFyYW1ldGVyIHZhbHVlcy48L3N1bW1hcnk+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0iYWRhcHRlck5hbWUiIHR5cGU9IlN0cmluZyI+VGhlIG5hbWUgb2YgdGhlIGFkYXB0ZXIgdG8gYmUgYWRkZWQuIFRoaXMgbWF0Y2hlcyB0aGUgbmFtZSB1c2VkDQogICAgICAgIC8vLyBpbiB0aGUgZGF0YS12YWwtbm5ubiBIVE1MIGF0dHJpYnV0ZSAod2hlcmUgbm5ubiBpcyB0aGUgYWRhcHRlciBuYW1lKS48L3BhcmFtPg0KICAgICAgICAvLy8gPHBhcmFtIG5hbWU9InJ1bGVOYW1lIiB0eXBlPSJTdHJpbmciIG9wdGlvbmFsPSJ0cnVlIj5bT3B0aW9uYWxdIFRoZSBuYW1lIG9mIHRoZSBqUXVlcnkgVmFsaWRhdGUgcnVsZS4gSWYgbm90IHByb3ZpZGVkLCB0aGUgdmFsdWUNCiAgICAgICAgLy8vIG9mIGFkYXB0ZXJOYW1lIHdpbGwgYmUgdXNlZCBpbnN0ZWFkLjwvcGFyYW0+DQogICAgICAgIC8vLyA8cmV0dXJucyB0eXBlPSJqUXVlcnkudmFsaWRhdG9yLnVub2J0cnVzaXZlLmFkYXB0ZXJzIiAvPg0KICAgICAgICByZXR1cm4gdGhpcy5hZGQoYWRhcHRlck5hbWUsIGZ1bmN0aW9uIChvcHRpb25zKSB7DQogICAgICAgICAgICBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsIHJ1bGVOYW1lIHx8IGFkYXB0ZXJOYW1lLCB0cnVlKTsNCiAgICAgICAgfSk7DQogICAgfTsNCg0KICAgIGFkYXB0ZXJzLmFkZE1pbk1heCA9IGZ1bmN0aW9uIChhZGFwdGVyTmFtZSwgbWluUnVsZU5hbWUsIG1heFJ1bGVOYW1lLCBtaW5NYXhSdWxlTmFtZSwgbWluQXR0cmlidXRlLCBtYXhBdHRyaWJ1dGUpIHsNCiAgICAgICAgLy8vIDxzdW1tYXJ5PkFkZHMgYSBuZXcgYWRhcHRlciB0byBjb252ZXJ0IHVub2J0cnVzaXZlIEhUTUwgaW50byBhIGpRdWVyeSBWYWxpZGF0ZSB2YWxpZGF0aW9uLCB3aGVyZQ0KICAgICAgICAvLy8gdGhlIGpRdWVyeSBWYWxpZGF0ZSB2YWxpZGF0aW9uIGhhcyB0aHJlZSBwb3RlbnRpYWwgcnVsZXMgKG9uZSBmb3IgbWluLW9ubHksIG9uZSBmb3IgbWF4LW9ubHksIGFuZA0KICAgICAgICAvLy8gb25lIGZvciBtaW4tYW5kLW1heCkuIFRoZSBIVE1MIHBhcmFtZXRlcnMgYXJlIGV4cGVjdGVkIHRvIGJlIG5hbWVkIC1taW4gYW5kIC1tYXguPC9zdW1tYXJ5Pg0KICAgICAgICAvLy8gPHBhcmFtIG5hbWU9ImFkYXB0ZXJOYW1lIiB0eXBlPSJTdHJpbmciPlRoZSBuYW1lIG9mIHRoZSBhZGFwdGVyIHRvIGJlIGFkZGVkLiBUaGlzIG1hdGNoZXMgdGhlIG5hbWUgdXNlZA0KICAgICAgICAvLy8gaW4gdGhlIGRhdGEtdmFsLW5ubm4gSFRNTCBhdHRyaWJ1dGUgKHdoZXJlIG5ubm4gaXMgdGhlIGFkYXB0ZXIgbmFtZSkuPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJtaW5SdWxlTmFtZSIgdHlwZT0iU3RyaW5nIj5UaGUgbmFtZSBvZiB0aGUgalF1ZXJ5IFZhbGlkYXRlIHJ1bGUgdG8gYmUgdXNlZCB3aGVuIHlvdSBvbmx5DQogICAgICAgIC8vLyBoYXZlIGEgbWluaW11bSB2YWx1ZS48L3BhcmFtPg0KICAgICAgICAvLy8gPHBhcmFtIG5hbWU9Im1heFJ1bGVOYW1lIiB0eXBlPSJTdHJpbmciPlRoZSBuYW1lIG9mIHRoZSBqUXVlcnkgVmFsaWRhdGUgcnVsZSB0byBiZSB1c2VkIHdoZW4geW91IG9ubHkNCiAgICAgICAgLy8vIGhhdmUgYSBtYXhpbXVtIHZhbHVlLjwvcGFyYW0+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0ibWluTWF4UnVsZU5hbWUiIHR5cGU9IlN0cmluZyI+VGhlIG5hbWUgb2YgdGhlIGpRdWVyeSBWYWxpZGF0ZSBydWxlIHRvIGJlIHVzZWQgd2hlbiB5b3UNCiAgICAgICAgLy8vIGhhdmUgYm90aCBhIG1pbmltdW0gYW5kIG1heGltdW0gdmFsdWUuPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJtaW5BdHRyaWJ1dGUiIHR5cGU9IlN0cmluZyIgb3B0aW9uYWw9InRydWUiPltPcHRpb25hbF0gVGhlIG5hbWUgb2YgdGhlIEhUTUwgYXR0cmlidXRlIHRoYXQNCiAgICAgICAgLy8vIGNvbnRhaW5zIHRoZSBtaW5pbXVtIHZhbHVlLiBUaGUgZGVmYXVsdCBpcyAibWluIi48L3BhcmFtPg0KICAgICAgICAvLy8gPHBhcmFtIG5hbWU9Im1heEF0dHJpYnV0ZSIgdHlwZT0iU3RyaW5nIiBvcHRpb25hbD0idHJ1ZSI+W09wdGlvbmFsXSBUaGUgbmFtZSBvZiB0aGUgSFRNTCBhdHRyaWJ1dGUgdGhhdA0KICAgICAgICAvLy8gY29udGFpbnMgdGhlIG1heGltdW0gdmFsdWUuIFRoZSBkZWZhdWx0IGlzICJtYXgiLjwvcGFyYW0+DQogICAgICAgIC8vLyA8cmV0dXJucyB0eXBlPSJqUXVlcnkudmFsaWRhdG9yLnVub2J0cnVzaXZlLmFkYXB0ZXJzIiAvPg0KICAgICAgICByZXR1cm4gdGhpcy5hZGQoYWRhcHRlck5hbWUsIFttaW5BdHRyaWJ1dGUgfHwgIm1pbiIsIG1heEF0dHJpYnV0ZSB8fCAibWF4Il0sIGZ1bmN0aW9uIChvcHRpb25zKSB7DQogICAgICAgICAgICB2YXIgbWluID0gb3B0aW9ucy5wYXJhbXMubWluLA0KICAgICAgICAgICAgICAgIG1heCA9IG9wdGlvbnMucGFyYW1zLm1heDsNCg0KICAgICAgICAgICAgaWYgKG1pbiAmJiBtYXgpIHsNCiAgICAgICAgICAgICAgICBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsIG1pbk1heFJ1bGVOYW1lLCBbbWluLCBtYXhdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKG1pbikgew0KICAgICAgICAgICAgICAgIHNldFZhbGlkYXRpb25WYWx1ZXMob3B0aW9ucywgbWluUnVsZU5hbWUsIG1pbik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIGlmIChtYXgpIHsNCiAgICAgICAgICAgICAgICBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsIG1heFJ1bGVOYW1lLCBtYXgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9Ow0KDQogICAgYWRhcHRlcnMuYWRkU2luZ2xlVmFsID0gZnVuY3Rpb24gKGFkYXB0ZXJOYW1lLCBhdHRyaWJ1dGUsIHJ1bGVOYW1lKSB7DQogICAgICAgIC8vLyA8c3VtbWFyeT5BZGRzIGEgbmV3IGFkYXB0ZXIgdG8gY29udmVydCB1bm9idHJ1c2l2ZSBIVE1MIGludG8gYSBqUXVlcnkgVmFsaWRhdGUgdmFsaWRhdGlvbiwgd2hlcmUNCiAgICAgICAgLy8vIHRoZSBqUXVlcnkgVmFsaWRhdGUgdmFsaWRhdGlvbiBydWxlIGhhcyBhIHNpbmdsZSB2YWx1ZS48L3N1bW1hcnk+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0iYWRhcHRlck5hbWUiIHR5cGU9IlN0cmluZyI+VGhlIG5hbWUgb2YgdGhlIGFkYXB0ZXIgdG8gYmUgYWRkZWQuIFRoaXMgbWF0Y2hlcyB0aGUgbmFtZSB1c2VkDQogICAgICAgIC8vLyBpbiB0aGUgZGF0YS12YWwtbm5ubiBIVE1MIGF0dHJpYnV0ZSh3aGVyZSBubm5uIGlzIHRoZSBhZGFwdGVyIG5hbWUpLjwvcGFyYW0+DQogICAgICAgIC8vLyA8cGFyYW0gbmFtZT0iYXR0cmlidXRlIiB0eXBlPSJTdHJpbmciPltPcHRpb25hbF0gVGhlIG5hbWUgb2YgdGhlIEhUTUwgYXR0cmlidXRlIHRoYXQgY29udGFpbnMgdGhlIHZhbHVlLg0KICAgICAgICAvLy8gVGhlIGRlZmF1bHQgaXMgInZhbCIuPC9wYXJhbT4NCiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPSJydWxlTmFtZSIgdHlwZT0iU3RyaW5nIiBvcHRpb25hbD0idHJ1ZSI+W09wdGlvbmFsXSBUaGUgbmFtZSBvZiB0aGUgalF1ZXJ5IFZhbGlkYXRlIHJ1bGUuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZhbHVlDQogICAgICAgIC8vLyBvZiBhZGFwdGVyTmFtZSB3aWxsIGJlIHVzZWQgaW5zdGVhZC48L3BhcmFtPg0KICAgICAgICAvLy8gPHJldHVybnMgdHlwZT0ialF1ZXJ5LnZhbGlkYXRvci51bm9idHJ1c2l2ZS5hZGFwdGVycyIgLz4NCiAgICAgICAgcmV0dXJuIHRoaXMuYWRkKGFkYXB0ZXJOYW1lLCBbYXR0cmlidXRlIHx8ICJ2YWwiXSwgZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgICAgICAgICAgIHNldFZhbGlkYXRpb25WYWx1ZXMob3B0aW9ucywgcnVsZU5hbWUgfHwgYWRhcHRlck5hbWUsIG9wdGlvbnMucGFyYW1zW2F0dHJpYnV0ZV0pOw0KICAgICAgICB9KTsNCiAgICB9Ow0KDQogICAgJGpRdmFsLmFkZE1ldGhvZCgiX19kdW1teV9fIiwgZnVuY3Rpb24gKHZhbHVlLCBlbGVtZW50LCBwYXJhbXMpIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfSk7DQoNCiAgICAkalF2YWwuYWRkTWV0aG9kKCJyZWdleCIsIGZ1bmN0aW9uICh2YWx1ZSwgZWxlbWVudCwgcGFyYW1zKSB7DQogICAgICAgIHZhciBtYXRjaDsNCiAgICAgICAgaWYgKHRoaXMub3B0aW9uYWwoZWxlbWVudCkpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgbWF0Y2ggPSBuZXcgUmVnRXhwKHBhcmFtcykuZXhlYyh2YWx1ZSk7DQogICAgICAgIHJldHVybiAobWF0Y2ggJiYgKG1hdGNoLmluZGV4ID09PSAwKSAmJiAobWF0Y2hbMF0ubGVuZ3RoID09PSB2YWx1ZS5sZW5ndGgpKTsNCiAgICB9KTsNCg0KICAgICRqUXZhbC5hZGRNZXRob2QoIm5vbmFscGhhbWluIiwgZnVuY3Rpb24gKHZhbHVlLCBlbGVtZW50LCBub25hbHBoYW1pbikgew0KICAgICAgICB2YXIgbWF0Y2g7DQogICAgICAgIGlmIChub25hbHBoYW1pbikgew0KICAgICAgICAgICAgbWF0Y2ggPSB2YWx1ZS5tYXRjaCgvXFcvZyk7DQogICAgICAgICAgICBtYXRjaCA9IG1hdGNoICYmIG1hdGNoLmxlbmd0aCA+PSBub25hbHBoYW1pbjsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbWF0Y2g7DQogICAgfSk7DQoNCiAgICBpZiAoJGpRdmFsLm1ldGhvZHMuZXh0ZW5zaW9uKSB7DQogICAgICAgIGFkYXB0ZXJzLmFkZFNpbmdsZVZhbCgiYWNjZXB0IiwgIm1pbXR5cGUiKTsNCiAgICAgICAgYWRhcHRlcnMuYWRkU2luZ2xlVmFsKCJleHRlbnNpb24iLCAiZXh0ZW5zaW9uIik7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHksIHdoZW4gdGhlICdleHRlbnNpb24nIHZhbGlkYXRpb24gbWV0aG9kIGRvZXMgbm90IGV4aXN0LCBzdWNoIGFzIHdpdGggdmVyc2lvbnMNCiAgICAgICAgLy8gb2YgSlF1ZXJ5IFZhbGlkYXRpb24gcGx1Z2luIHByaW9yIHRvIDEuMTAsIHdlIHNob3VsZCB1c2UgdGhlICdhY2NlcHQnIG1ldGhvZCBmb3INCiAgICAgICAgLy8gdmFsaWRhdGluZyB0aGUgZXh0ZW5zaW9uLCBhbmQgaWdub3JlIG1pbWUtdHlwZSB2YWxpZGF0aW9ucyBhcyB0aGV5IGFyZSBub3Qgc3VwcG9ydGVkLg0KICAgICAgICBhZGFwdGVycy5hZGRTaW5nbGVWYWwoImV4dGVuc2lvbiIsICJleHRlbnNpb24iLCAiYWNjZXB0Iik7DQogICAgfQ0KDQogICAgYWRhcHRlcnMuYWRkU2luZ2xlVmFsKCJyZWdleCIsICJwYXR0ZXJuIik7DQogICAgYWRhcHRlcnMuYWRkQm9vbCgiY3JlZGl0Y2FyZCIpLmFkZEJvb2woImRhdGUiKS5hZGRCb29sKCJkaWdpdHMiKS5hZGRCb29sKCJlbWFpbCIpLmFkZEJvb2woIm51bWJlciIpLmFkZEJvb2woInVybCIpOw0KICAgIGFkYXB0ZXJzLmFkZE1pbk1heCgibGVuZ3RoIiwgIm1pbmxlbmd0aCIsICJtYXhsZW5ndGgiLCAicmFuZ2VsZW5ndGgiKS5hZGRNaW5NYXgoInJhbmdlIiwgIm1pbiIsICJtYXgiLCAicmFuZ2UiKTsNCiAgICBhZGFwdGVycy5hZGRNaW5NYXgoIm1pbmxlbmd0aCIsICJtaW5sZW5ndGgiKS5hZGRNaW5NYXgoIm1heGxlbmd0aCIsICJtaW5sZW5ndGgiLCAibWF4bGVuZ3RoIik7DQogICAgYWRhcHRlcnMuYWRkKCJlcXVhbHRvIiwgWyJvdGhlciJdLCBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICB2YXIgcHJlZml4ID0gZ2V0TW9kZWxQcmVmaXgob3B0aW9ucy5lbGVtZW50Lm5hbWUpLA0KICAgICAgICAgICAgb3RoZXIgPSBvcHRpb25zLnBhcmFtcy5vdGhlciwNCiAgICAgICAgICAgIGZ1bGxPdGhlck5hbWUgPSBhcHBlbmRNb2RlbFByZWZpeChvdGhlciwgcHJlZml4KSwNCiAgICAgICAgICAgIGVsZW1lbnQgPSAkKG9wdGlvbnMuZm9ybSkuZmluZCgiOmlucHV0IikuZmlsdGVyKCJbbmFtZT0nIiArIGVzY2FwZUF0dHJpYnV0ZVZhbHVlKGZ1bGxPdGhlck5hbWUpICsgIiddIilbMF07DQoNCiAgICAgICAgc2V0VmFsaWRhdGlvblZhbHVlcyhvcHRpb25zLCAiZXF1YWxUbyIsIGVsZW1lbnQpOw0KICAgIH0pOw0KICAgIGFkYXB0ZXJzLmFkZCgicmVxdWlyZWQiLCBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICAvLyBqUXVlcnkgVmFsaWRhdGUgZXF1YXRlcyAicmVxdWlyZWQiIHdpdGggIm1hbmRhdG9yeSIgZm9yIGNoZWNrYm94IGVsZW1lbnRzDQogICAgICAgIGlmIChvcHRpb25zLmVsZW1lbnQudGFnTmFtZS50b1VwcGVyQ2FzZSgpICE9PSAiSU5QVVQiIHx8IG9wdGlvbnMuZWxlbWVudC50eXBlLnRvVXBwZXJDYXNlKCkgIT09ICJDSEVDS0JPWCIpIHsNCiAgICAgICAgICAgIHNldFZhbGlkYXRpb25WYWx1ZXMob3B0aW9ucywgInJlcXVpcmVkIiwgdHJ1ZSk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICBhZGFwdGVycy5hZGQoInJlbW90ZSIsIFsidXJsIiwgInR5cGUiLCAiYWRkaXRpb25hbGZpZWxkcyJdLCBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICB2YXIgdmFsdWUgPSB7DQogICAgICAgICAgICB1cmw6IG9wdGlvbnMucGFyYW1zLnVybCwNCiAgICAgICAgICAgIHR5cGU6IG9wdGlvbnMucGFyYW1zLnR5cGUgfHwgIkdFVCIsDQogICAgICAgICAgICBkYXRhOiB7fQ0KICAgICAgICB9LA0KICAgICAgICAgICAgcHJlZml4ID0gZ2V0TW9kZWxQcmVmaXgob3B0aW9ucy5lbGVtZW50Lm5hbWUpOw0KDQogICAgICAgICQuZWFjaChzcGxpdEFuZFRyaW0ob3B0aW9ucy5wYXJhbXMuYWRkaXRpb25hbGZpZWxkcyB8fCBvcHRpb25zLmVsZW1lbnQubmFtZSksIGZ1bmN0aW9uIChpLCBmaWVsZE5hbWUpIHsNCiAgICAgICAgICAgIHZhciBwYXJhbU5hbWUgPSBhcHBlbmRNb2RlbFByZWZpeChmaWVsZE5hbWUsIHByZWZpeCk7DQogICAgICAgICAgICB2YWx1ZS5kYXRhW3BhcmFtTmFtZV0gPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gJChvcHRpb25zLmZvcm0pLmZpbmQoIjppbnB1dCIpLmZpbHRlcigiW25hbWU9JyIgKyBlc2NhcGVBdHRyaWJ1dGVWYWx1ZShwYXJhbU5hbWUpICsgIiddIik7DQogICAgICAgICAgICAgICAgLy8gRm9yIGNoZWNrYm94ZXMgYW5kIHJhZGlvIGJ1dHRvbnMsIG9ubHkgcGljayB1cCB2YWx1ZXMgZnJvbSBjaGVja2VkIGZpZWxkcy4NCiAgICAgICAgICAgICAgICBpZiAoZmllbGQuaXMoIjpjaGVja2JveCIpKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZC5maWx0ZXIoIjpjaGVja2VkIikudmFsKCkgfHwgZmllbGQuZmlsdGVyKCI6aGlkZGVuIikudmFsKCkgfHwgJyc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZpZWxkLmlzKCI6cmFkaW8iKSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmllbGQuZmlsdGVyKCI6Y2hlY2tlZCIpLnZhbCgpIHx8ICcnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGQudmFsKCk7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9KTsNCg0KICAgICAgICBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsICJyZW1vdGUiLCB2YWx1ZSk7DQogICAgfSk7DQogICAgYWRhcHRlcnMuYWRkKCJwYXNzd29yZCIsIFsibWluIiwgIm5vbmFscGhhbWluIiwgInJlZ2V4Il0sIGZ1bmN0aW9uIChvcHRpb25zKSB7DQogICAgICAgIGlmIChvcHRpb25zLnBhcmFtcy5taW4pIHsNCiAgICAgICAgICAgIHNldFZhbGlkYXRpb25WYWx1ZXMob3B0aW9ucywgIm1pbmxlbmd0aCIsIG9wdGlvbnMucGFyYW1zLm1pbik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKG9wdGlvbnMucGFyYW1zLm5vbmFscGhhbWluKSB7DQogICAgICAgICAgICBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsICJub25hbHBoYW1pbiIsIG9wdGlvbnMucGFyYW1zLm5vbmFscGhhbWluKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAob3B0aW9ucy5wYXJhbXMucmVnZXgpIHsNCiAgICAgICAgICAgIHNldFZhbGlkYXRpb25WYWx1ZXMob3B0aW9ucywgInJlZ2V4Iiwgb3B0aW9ucy5wYXJhbXMucmVnZXgpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgYWRhcHRlcnMuYWRkKCJmaWxlZXh0ZW5zaW9ucyIsIFsiZXh0ZW5zaW9ucyJdLCBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICBzZXRWYWxpZGF0aW9uVmFsdWVzKG9wdGlvbnMsICJleHRlbnNpb24iLCBvcHRpb25zLnBhcmFtcy5leHRlbnNpb25zKTsNCiAgICB9KTsNCg0KICAgICQoZnVuY3Rpb24gKCkgew0KICAgICAgICAkalF2YWwudW5vYnRydXNpdmUucGFyc2UoZG9jdW1lbnQpOw0KICAgIH0pOw0KDQogICAgcmV0dXJuICRqUXZhbC51bm9idHJ1c2l2ZTsNCn0pKTsNCg==";
            var bytes = Convert.FromBase64String(s);
            return File(bytes, "text/javascript");
        }
    }
}